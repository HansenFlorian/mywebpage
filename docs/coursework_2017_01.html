<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />




<title>Coursework 1</title>

<script src="site_libs/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/bootstrap.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<link href="site_libs/highlightjs-1.1/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-1.1/highlight.js"></script>

<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>
<script type="text/javascript">
if (window.hljs && document.readyState && document.readyState === "complete") {
   window.setTimeout(function() {
      hljs.initHighlighting();
   }, 0);
}
</script>



<style type="text/css">
h1 {
  font-size: 34px;
}
h1.title {
  font-size: 38px;
}
h2 {
  font-size: 30px;
}
h3 {
  font-size: 24px;
}
h4 {
  font-size: 18px;
}
h5 {
  font-size: 16px;
}
h6 {
  font-size: 12px;
}
.table th:not([align]) {
  text-align: left;
}
</style>


</head>

<body>

<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
  height: auto;
}
.tabbed-pane {
  padding-top: 12px;
}
button.code-folding-btn:focus {
  outline: none;
}
</style>


<style type="text/css">
/* padding for bootstrap navbar */
body {
  padding-top: 51px;
  padding-bottom: 40px;
}
/* offset scroll position for anchor links (for fixed navbar)  */
.section h1 {
  padding-top: 56px;
  margin-top: -56px;
}

.section h2 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h3 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h4 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h5 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h6 {
  padding-top: 56px;
  margin-top: -56px;
}
</style>

<script>
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.parent().addClass('active');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');
});
</script>


<div class="container-fluid main-container">

<!-- tabsets -->
<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});
</script>

<!-- code folding -->






<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Cross-Cultural Symptoms & their releives</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div class="fluid-row" id="header">



<h1 class="title toc-ignore">Coursework 1</h1>

</div>


<div id="instructions" class="section level1">
<h1>Instructions</h1>
<p>Download the <a href="coursework1.Rmd" download>RMarkdown file</a> and edit it with your answers, replacing any <code>NULL</code> values with your solution code and adding any additional code that you need. You can add or modify code in an existing block, but please <strong>DO NOT</strong> add or remove any code blocks, and <strong>DO NOT</strong> change any of the code block names. Once completed, submit your RMarkdown file using the <a href="http://moodle2.gla.ac.uk/mod/assign/view.php?id=781833">link in Moodle</a>.</p>
</div>
<div id="data" class="section level1">
<h1>Data</h1>
<p>Data in the files (<a href="https://rgup.gitlab.io/research_cycle/data/empathizing.csv" class="uri">https://rgup.gitlab.io/research_cycle/data/empathizing.csv</a>) and (<a href="https://rgup.gitlab.io/research_cycle/data/systemizing.csv" class="uri">https://rgup.gitlab.io/research_cycle/data/systemizing.csv</a>) are responses to the short forms of the <a href="https://doi.org/10.1016/j.paid.2006.03.017">Empathizing and Systemizing Quotient short forms</a>.</p>
<p>The variable <code>user_id</code> is the participant’s unique ID, while the variable <code>id</code> is a unique ID for that questionnaire completion. Some participants completed both questionnaires on the same day, others only completed one, others completed the questionnaires multiple times. The columns <code>starttime</code> and <code>endtime</code> contain the timestamps for when each questionnaire was started and completed.</p>
<p><em>Scoring</em>: An individual scores two points if they strongly display a systemizing/empathizing response, and one point if they slightly display a systemizing/empathizing response (i.e., each forward (F) item scored 2, 1, 0, 0; each reversed (R) item scored 0, 0, 1, 2).</p>
<p>In the data files, responses were coded as follows:</p>
<ul>
<li>1 = Strongly agree</li>
<li>2 = Slightly agree</li>
<li>3 = Slightly disagree</li>
<li>4 = Strongly disagree</li>
</ul>
<div id="empathizing-eq-short" class="section level2">
<h2>Empathizing (EQ-Short)</h2>
<p>q2663, F, I can easily tell if someone else wants to enter a conversation.<br />
q2664, F, I really enjoy caring for other people.<br />
q2665, R, I find it hard to know what to do in a social situation.<br />
q2666, R, I often find it difficult to judge if something is rude or polite.<br />
q2667, R, In a conversation, I tend to focus on my own thoughts rather than on what my listener might be thinking.<br />
q2668, F, I can pick up quickly if someone says one thing but means another.<br />
q2669, R, It is hard for me to see why some things upset people so much.<br />
q2670, F, I find it easy to put myself in somebody else’s shoes.<br />
q2671, F, I am good at predicting how someone will feel.<br />
q2672, F, I am quick to spot when someone in a group is feeling awkward or uncomfortable.<br />
q2673, R, I can’t always see why someone should have felt offended by a remark.<br />
q2674, F, I don’t tend to find social situations confusing.<br />
q2675, F, Other people tell me I am good at understanding how they are feeling and what they are thinking.<br />
q2676, F, I can easily tell if someone else is interested or bored with what I am saying.<br />
q2677, F, Friends usually talk to me about their problems as they say that I am very understanding.<br />
q2678, F, I can sense if I am intruding, even if the other person doesn’t tell me.<br />
q2679, R, Other people often say that I am insensitive, though I don’t always see why.<br />
q2680, F, I can tune into how someone else feels rapidly and intuitively.<br />
q2681, F, I can easily work out what another person might want to talk about.<br />
q2682, F, I can tell if someone is masking their true emotion.<br />
q2683, F, I am good at predicting what someone will do.<br />
q2684, F, I tend to get emotionally involved with a friend’s problems.</p>
</div>
<div id="systemizing-sq-short" class="section level2">
<h2>Systemizing (SQ-Short)</h2>
<p>q2616, F, If I were buying a car, I would want to obtain specific information about its engine.<br />
q2617, F, If there was a problem with the electrical wiring in my home, I’d be able to fix it myself.<br />
q2618, R, I rarely read articles or web pages about new technology.<br />
q2619, R, I do not enjoy games that involve a high degree of strategy.<br />
q2620, F, I am fascinated by how machines work.<br />
q2621, F, In math, I am intrigued by the rules and patterns governing numbers.<br />
q2622, R, I find it difficult to understand instruction manuals for putting appliances together.<br />
q2623, F, If I were buying a computer, I would want to know exact details about its hard disc drive capacity and processor speed.<br />
q2624, R, I find it difficult to read and understand maps.<br />
q2625, R, When I look at a piece of furniture, I do not notice the details of how it was constructed.<br />
q2626, R, I find it difficult to learn my way around a new city.<br />
q2627, R, I do not tend to watch science documentaries on television or read articles about science and nature.<br />
q2628, F, If I were buying a stereo, I would want to know about its precise technical features.<br />
q2629, F, I find it easy to grasp exactly how odds work in betting.<br />
q2630, R, I am not very meticulous when I carry out D.I.Y.<br />
q2631, F, When I look at a building, I am curious about the precise way it was constructed.<br />
q2632, R, I find it difficult to understand information the bank sends me on different investment and saving systems.<br />
q2633, F, When travelling by train, I often wonder exactly how the rail networks are coordinated.<br />
q2634, R, If I were buying a camera, I would not look carefully into the quality of the lens.<br />
q2635, R, When I hear the weather forecast, I am not very interested in the meteorological patterns.<br />
q2636, F, When I look a mountain, I think about how precisely it was formed.<br />
q2637, F, I can easily visualize how the motorways in my region link up.<br />
q2638, R, When I’m in a plane, I do not think about the aerodynamics.<br />
q2639, F, I am interested in knowing the path a river takes from its source to the sea.<br />
q2640, R, I am not interested in understanding how wireless communication works.</p>
</div>
</div>
<div id="assignment" class="section level1">
<h1>Assignment</h1>
<p>Answer the following questions by editing the code block below each question.</p>
<p>Note: please enter the <em>code</em> that generates the correct answer; don’t simply type in the numbers. The code should give the right answers even if the source data files change (new rows of values are added or subtracted).</p>
<p>In this RMarkdown file:</p>
<ul>
<li><em>DO NOT</em> install/update/remove any packages</li>
<li><em>DO NOT</em> set your working directory</li>
<li><em>DO NOT</em> use the <code>View()</code> function</li>
<li><em>DO NOT</em> reference any help functions or package vignettes.</li>
</ul>
<p>You will be penalized if your file includes any of the above features or any other code that is unnecessary for answering the question, or that produces undesireable side effects.</p>
<p>Setup block. Load any add-on packages you need here.</p>
<pre class="r"><code>library(tidyverse)</code></pre>
<div id="loading-and-inspecting-files" class="section level2">
<h2>Loading and inspecting files</h2>
<ol style="list-style-type: decimal">
<li><p>Load in the two CSV files directly from the web (use the URLs above). How many times were the empathizing and systemizing questionnaires completed? Save these as the variables:</p>
<ul>
<li><code>emp_total_n</code></li>
<li><code>sys_total_n</code></li>
</ul></li>
</ol>
<pre class="r"><code>## TODO: read the data

emp_total_n &lt;- read_csv(&quot;https://rgup.gitlab.io/research_cycle/data/empathizing.csv&quot;)
sys_total_n &lt;- read_csv(&quot;https://rgup.gitlab.io/research_cycle/data/systemizing.csv&quot;)</code></pre>
</div>
<div id="calculating-durations" class="section level2">
<h2>Calculating durations</h2>
<p>How long did it take people to complete each questionnaire?</p>
<ol start="2" style="list-style-type: decimal">
<li>Create the following variables:</li>
</ol>
<ul>
<li><code>mean_emp</code> = mean duration (in seconds) for empathizing questionnaire (before exclusions)</li>
<li><code>sd_emp</code> = SD of duration (in seconds) for empathizing questionnaire (before exclusions)</li>
<li><code>mean_sys</code> = mean duration (in seconds) for systemizing questionnaire (before exclusions)</li>
<li><code>sd_sys</code> = SD of duration (in seconds) for systemizing questionnaire (before exclusions)</li>
</ul>
<pre class="r"><code>## add any additional code you need

#emp_total_n$takentime &lt;- with(emp_total_n, difftime(endtime, starttime, units=&quot;secs&quot;)) is better because shorter than  mutate(emp_total_n, takentime = difftime(endtime,starttime,units=&quot;secs&quot;)), but u said use tidyverse

emp_total_n2 &lt;- emp_total_n %&gt;% mutate(takentime = difftime(endtime,starttime,units=&quot;secs&quot;))
sys_total_n2 &lt;- sys_total_n %&gt;% mutate(takentime = difftime(endtime,starttime,units=&quot;secs&quot;))

mean_emp &lt;- emp_total_n2 %&gt;% summarise(mean(takentime))
sd_emp &lt;-  emp_total_n2 %&gt;% summarise(sd(takentime))
mean_sys &lt;- sys_total_n2 %&gt;% summarise(mean(takentime))
sd_sys &lt;- sys_total_n2 %&gt;% summarise(sd(takentime))
#some other smooth basic alternatives
#mean_sys &lt;- mean(with(sys_total_n,difftime(endtime,starttime,units=&quot;secs&quot;)))
#sd_sys &lt;- sd(with(sys_total_n,difftime(endtime,starttime,units=&quot;secs&quot;)))</code></pre>
<ol start="3" style="list-style-type: decimal">
<li>Graph the distributions for each questionnaire after excluding times that are more than 3 SDs above the mean for each questionnaire.</li>
</ol>
<pre class="r"><code>emp_total_n3 &lt;- emp_total_n2 %&gt;%
  select(user_id, takentime) %&gt;%
  filter(takentime &lt; (mean_emp + 3*sd_emp + 1)) %&gt;%
  mutate(eors = &quot;emp&quot;)
sys_total_n3 &lt;- sys_total_n2 %&gt;%
  select(user_id, takentime) %&gt;%
  filter(takentime &lt; (mean_sys + 3*sd_sys + 1)) %&gt;%
  mutate(eors = &quot;sys&quot;)

union(emp_total_n3, sys_total_n3) %&gt;%
  ggplot(aes(takentime, fill = eors)) +
  geom_density(alpha = 0.4) +
  labs(title =&quot;Population density vs time taken in seconds by Questionaire&quot;, x = &quot;Time taken (secs)&quot;, y = &quot;Density&quot;) +
  scale_fill_discrete(name = &quot;Questionaire&quot;) +
  theme_grey(base_size=20) +
  theme(plot.title = element_text(size=16))</code></pre>
<p><img src="coursework_2017_01_files/figure-html/P3-1.png" width="768" /></p>
<pre class="r"><code>## TODO: create a graph</code></pre>
</div>
<div id="questionnaire-completion" class="section level2">
<h2>Questionnaire completion</h2>
<ol start="4" style="list-style-type: decimal">
<li>How many people completed both questionnaires <em>for the first time</em> on the same day? Save this number as <code>first_time_n</code>.</li>
</ol>
<p><strong>Remember to check for people who completed a questionnaire more than once.</strong></p>
<pre class="r"><code>## add any additional code you need

emp4 &lt;- emp_total_n2 %&gt;%
  mutate(date = as.Date(endtime, format=&quot;%a %b %d %H:%M:%S EST %Y&quot;)) %&gt;%
  select(user_id, date, sex, age)
sys4 &lt;- sys_total_n2 %&gt;%
  mutate(date = as.Date(endtime, format=&quot;%a %b %d %H:%M:%S EST %Y&quot;)) %&gt;%
  select(user_id, date)
tot4 &lt;- sys4 %&gt;%
  inner_join(emp4, &quot;user_id&quot;) %&gt;%
  filter(date.x == date.y) %&gt;%
  distinct(user_id, .keep_all = TRUE) 

first_time_n &lt;- tot4 %&gt;%
  count()</code></pre>
</div>
<div id="respondent-demographics" class="section level2">
<h2>Respondent demographics</h2>
<ol start="5" style="list-style-type: decimal">
<li>Create a table of demographic information by sex with the columns <code>sex</code>, <code>n</code>, <code>mean age</code>, <code>sd age</code>, and <code>number missing age</code>, only for people who completed both questionnaires for the first time on the same day (i.e., use the data table you created for question 4). Save the table as <code>demog_table</code>.</li>
</ol>
<pre class="r"><code>## add any additional code you need

m_f &lt;- tot4 %&gt;%
  group_by(sex) %&gt;%
  count()

na_age &lt;- tot4 %&gt;%
  filter(is.na(age)) %&gt;%
  group_by(sex) %&gt;%
  count()

m_age &lt;- tot4 %&gt;%
  group_by(sex) %&gt;%
  summarise(&#39;mean age&#39; = mean(age, na.rm = TRUE),sd = sd(age, na.rm = TRUE))

demog_table &lt;- inner_join(m_f, m_age) %&gt;%
  inner_join(na_age, &quot;sex&quot;) %&gt;%
  ungroup() %&gt;%
  rename(&quot;n&quot; = n.x, &quot;number missing age&quot; = n.y)</code></pre>
<ol start="6" style="list-style-type: decimal">
<li>What is wrong with the SD? Address it by changing implausible ages to <code>NA</code> and re-calcuating the table above, saving it as <code>demog_table_fixed</code>.</li>
</ol>
<pre class="r"><code>## add any additional code you need
m_age_fix &lt;- tot4 %&gt;%
  mutate(age = replace(age, which(age &lt; 18 | age &gt; 100), NA)) %&gt;%
  group_by(sex) %&gt;%
  summarise(&#39;mean age&#39; = mean(age, na.rm = TRUE),sd = sd(age, na.rm = TRUE))

demog_table_fixed &lt;- inner_join(m_f, m_age_fix) %&gt;%
  inner_join(na_age, &quot;sex&quot;) %&gt;%
  ungroup() %&gt;%
  rename(&quot;n&quot; = n.x, &quot;number missing age&quot; = n.y)</code></pre>
</div>
<div id="exclusions" class="section level2">
<h2>Exclusions</h2>
<p>If someone takes less than 30 seconds to fill out the questionnaire or gives the same reponse for every question, we can assume they aren’t taking the study seriously.</p>
<ol start="7" style="list-style-type: decimal">
<li>Filter out non-serious responders. Store the resulting data in the variable named <code>emp_sys_cleaned</code>. You will use this as the source table in later problems.</li>
</ol>
<pre class="r"><code>#remove monotone answers

emp7 &lt;- tot4 %&gt;% 
  inner_join(emp_total_n) %&gt;%
  gather(qn,r, q2663:q2684) %&gt;%
  group_by(user_id,r) %&gt;%
  summarise(count = n()) %&gt;%
  na.omit() %&gt;%
  group_by(user_id) %&gt;%
  summarise(count = n()) %&gt;%
  filter(count &gt; 1) %&gt;% select(user_id)

sys7 &lt;- tot4 %&gt;%
  inner_join(sys_total_n) %&gt;%
  gather(qn,r, q2616:q2640) %&gt;%
  group_by(user_id,r) %&gt;%
  summarise(count = n()) %&gt;%
  na.omit() %&gt;%
  group_by(user_id) %&gt;%
  summarise(count = n()) %&gt;%
  filter(count &gt; 1) %&gt;%
  select(user_id)

#remove 30 sec answers

tot7 &lt;- tot4 %&gt;%
  inner_join(emp_total_n2, &quot;user_id&quot;) %&gt;%
  inner_join(sys_total_n2, &quot;user_id&quot;) %&gt;%
  distinct(user_id, .keep_all = TRUE) %&gt;%
  filter(takentime.x &gt;= 30, takentime.y &gt;= 30) %&gt;%
  select(user_id)

#join all together (monotone removed, less than 30 sec)

emp_sys_cleaned &lt;- inner_join(sys7, emp7) %&gt;%
  inner_join(tot7)</code></pre>
<ol start="8" style="list-style-type: decimal">
<li>Create the following variables:</li>
</ol>
<ul>
<li><code>excluded_short</code> = How many people took less than 30 seconds on at least one questionnaire?</li>
<li><code>excluded_one</code> = How many people gave the same response to each question in at least one questionnaire?</li>
<li><code>excluded_total</code> = How many people are you excluding in total?</li>
</ul>
<pre class="r"><code>tot8 &lt;- inner_join(sys7, emp7) %&gt;%
  select(user_id)
excluded_short &lt;- tot4 %&gt;%
  anti_join(tot7) %&gt;%
  count()
excluded_one &lt;- tot4 %&gt;%
  anti_join(tot8) %&gt;%
  count()

excluded_total &lt;- tot4 %&gt;%
  anti_join(emp_sys_cleaned) %&gt;%
  count()</code></pre>
<ol start="9" style="list-style-type: decimal">
<li>Write up your exclusion criteria and numbers of participants excluded as if for the methods section of a paper. Use inline code to generate any numbers used in your description; don’t just type them.</li>
</ol>
<p>-<em>-</em>-<em>-</em>- do not delete</p>
<p>We excluded from the analyses participants who took less than 30 seconds to respond to either of the questionaires 28 and those who only gave one type of response on either of the questionaires 21. As some of these overlapped, 33 were excluded in total. This left 3773 participants.</p>
<p>-<em>-</em>-<em>-</em>- do not delete</p>
</div>
<div id="create-eq-and-sq-scores" class="section level2">
<h2>Create EQ and SQ scores</h2>
<p>Calculate the EQ and SQ scores from the questionnaire responses.</p>
<p>Remember that forward coded (F) questions are coded:</p>
<ol style="list-style-type: decimal">
<li>strongly agree = 2</li>
<li>slightly agree = 1</li>
<li>slightly disagree = 0</li>
<li>strongly disagree = 0</li>
</ol>
<p>while reverse-coded (R) questions are coded:</p>
<ol style="list-style-type: decimal">
<li>strongly agree = 0</li>
<li>slightly agree = 0</li>
<li>slightly disagree = 1</li>
<li>strongly disagree = 2</li>
</ol>
<ol start="10" style="list-style-type: decimal">
<li>Create a table of mean EQ and SQ by sex and save it as <code>EQ_SQ_scores</code>. Include the columns <code>sex</code>, <code>n</code>, <code>mean_EQ</code>, <code>mean_SQ</code>, <code>missing_EQ</code>, and <code>missing_SQ</code> (how many people have a missing score).</li>
</ol>
<pre class="r"><code>## add any additional code you need

qn = sys_total_n %&gt;%
  gather(qn,r, q2616:q2640) %&gt;%
  group_by(qn) %&gt;%
  summarise(count = n()) %&gt;%
  select(qn)

direction = c(&#39;F&#39;, &#39;F&#39;, &#39;R&#39;, &#39;R&#39;, &#39;F&#39;, &#39;F&#39;, &#39;R&#39;, &#39;F&#39;, &#39;R&#39;, &#39;R&#39;, &#39;R&#39;, &#39;R&#39;, &#39;F&#39;, &#39;F&#39;, &#39;R&#39;, &#39;F&#39;, &#39;R&#39;, &#39;F&#39;, &#39;R&#39;, &#39;R&#39;, &#39;F&#39;,  &#39;F&#39;, &#39;R&#39;, &#39;F&#39;, &#39;R&#39;) 

stable = data.frame(qn, direction) 


qn = emp_total_n %&gt;%
  gather(qn,r, q2663:q2684) %&gt;%
  group_by(qn) %&gt;%
  summarise(count = n()) %&gt;%
  select(qn)

direction = c(&#39;F&#39;, &#39;F&#39;, &#39;R&#39;, &#39;R&#39;, &#39;R&#39;, &#39;F&#39;, &#39;R&#39;, &#39;F&#39;, &#39;F&#39;, &#39;F&#39;, &#39;R&#39;, &#39;F&#39;, &#39;F&#39;, &#39;F&#39;, &#39;F&#39;, &#39;F&#39;, &#39;R&#39;, &#39;F&#39;, &#39;F&#39;, &#39;F&#39;, &#39;F&#39;,  &#39;F&#39;) 

etable = data.frame(qn, direction) 

psex &lt;- emp_sys_cleaned %&gt;%
  left_join(emp_total_n) %&gt;%
  distinct(user_id, .keep_all = TRUE)  %&gt;%
  select(user_id, sex)

SQm &lt;- emp_sys_cleaned %&gt;%
  inner_join(sys_total_n2) %&gt;%
  gather(qn,r, q2616:q2640) %&gt;%
  inner_join(stable) %&gt;%
  mutate(r =ifelse(direction == &quot;F&quot;, r, 5-r)) %&gt;%
  mutate(r =ifelse(r == (1|2), 0, r-2)) %&gt;%
  group_by(user_id) %&gt;%
  summarize(score = (sum(r))) %&gt;%
  inner_join(psex) %&gt;%
  group_by(sex) %&gt;%
  summarise(mean_SQ = mean(score, na.rm=TRUE),missing_SQ =sum(is.na(score)))

EQm &lt;- emp_sys_cleaned %&gt;%
  inner_join(emp_total_n2) %&gt;%
  gather(qn,r, q2663:q2684) %&gt;%
  inner_join(etable) %&gt;%
  mutate(r =ifelse(direction == &quot;F&quot;, r, 5-r)) %&gt;%
  mutate(r =ifelse(r == (1|2), 0, r-2)) %&gt;%
  group_by(user_id) %&gt;%
  summarize(score = (sum(r))) %&gt;%
  inner_join(psex) %&gt;%
  group_by(sex) %&gt;%
  summarise(mean_EQ = mean(score, na.rm=TRUE),missing_EQ =sum(is.na(score)))

EQ_SQ_scores &lt;- EQm %&gt;%
  inner_join(SQm)</code></pre>
<ol start="11" style="list-style-type: decimal">
<li>Write code to re-create the following graph of the EQ and SQ score distributions for men and women.</li>
</ol>
<div class="figure">
<img src="https://rgup.gitlab.io/research_cycle/images/coursework1/graph.png" />

</div>
<pre class="r"><code>sscores &lt;- emp_sys_cleaned %&gt;%
  inner_join(sys_total_n2) %&gt;%
  distinct(user_id, .keep_all = TRUE) %&gt;%
  gather(qn,r, q2616:q2640) %&gt;% inner_join(stable) %&gt;%
  mutate(r =ifelse(direction == &quot;F&quot;, r, 5-r)) %&gt;%
  mutate(r =ifelse(r == (1|2), 0, r-2)) %&gt;%
  group_by(user_id) %&gt;% summarize(score = (sum(r))) %&gt;%
  mutate(eors = &#39;SQ Scores&#39;)

escores &lt;- emp_sys_cleaned %&gt;%
  inner_join(emp_total_n2) %&gt;%
  distinct(user_id, .keep_all = TRUE) %&gt;%
  gather(qn,r, q2663:q2684) %&gt;%
  inner_join(etable) %&gt;%
  mutate(r =ifelse(direction == &quot;F&quot;, r, 5-r)) %&gt;%
  mutate(r =ifelse(r == (1|2), 0, r-2)) %&gt;%
  group_by(user_id) %&gt;% summarize(score = (sum(r))) %&gt;%
  mutate(eors = &#39;EQ Scores&#39;)

tot11 &lt;- sscores %&gt;%
  union(escores) %&gt;%
  inner_join(psex) %&gt;%
  filter(!is.na(sex))


dodge &lt;- position_dodge(width = 1.1)

tot11 %&gt;%  
  ggplot(aes(eors, score, fill = sex)) +
  geom_violin(
    draw_quantiles = c(0.25,.5,.75),
    colour = &quot;black&quot;,
    size = 0.6,
    width = 1.1,
    alpha = 0.52,
    position = dodge ) +
  geom_boxplot(
    colour = &quot;black&quot;,
    width = 0.15,
    position = dodge
    ) +
    labs(title =&quot;EQ and SQ for Women and Men&quot;, x = &quot;&quot;, y = &quot;Score (0-44 for EQ; 0-50 for SQ&quot;) +
    scale_fill_manual(name = &quot;Participant Sex&quot;,values=c(&quot;darkorange&quot;, &quot;darkgreen&quot;)) +
    theme_gray(base_size=17) </code></pre>
<p><img src="coursework_2017_01_files/figure-html/P11-1.png" width="768" /> I know it looks a bit off, but it is interesting to see how the quantiles change through the exclusion of the outliers. Why are your curves more smooth?</p>
</div>
</div>




</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
